# Gitleaks configuration for GPG Signing Service
title = "gitleaks config"

[extend]
useDefault = true

# Allowlist for test files and documentation
[[allowlists]]
description = "Test fixtures with PGP keys"
paths = [
  '''src/__tests__/.*\.test\.ts$''',
  '''scripts/key-size\.py$''',
  '''API\.md$''',
  '''README\.md$''',
  '''scripts/generate-key\.sh$''',
]

# Skip specific commits that introduced test fixtures
[[allowlists]]
description = "Commits introducing test fixtures"
commits = [
  "21e000ed60165c243ec387af3f14cff0169d1f4e",  # scripts/key-size.py PGP test fixture
  "4b6fe507bc8c2ec1e65d69969f00bd897e1577b9",  # scripts/generate-key.sh example curl
  "0deeb13eee38f309dbf5137192a616ef52b9993d",  # API.md documentation example
]

# Additional stopword patterns for test fixtures
[[rules]]
id = "test-fixture-pgp"
description = "Allow PGP test fixtures in scripts"
regex = '''-----BEGIN PGP'''
path = '''scripts/.*'''

[[rules]]
id = "example-auth-header"
description = "Allow placeholder auth tokens in example scripts"
regex = '''Authorization: Bearer \*+'''
path = '''scripts/generate-key\.sh'''
